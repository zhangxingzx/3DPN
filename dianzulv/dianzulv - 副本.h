#pragma once
#include <QtCharts/QtCharts>
QT_CHARTS_USE_NAMESPACE   //QtCharts必须要，放在最前面才不报错
#include <QtCharts/QSplineSeries>
#include <QtWidgets/QMainWindow>
#include "ui_dianzulv.h"
#include <QThread> 

class dianzulv : public QMainWindow
{
    Q_OBJECT

public:
    dianzulv(QWidget *parent = Q_NULLPTR);
	~dianzulv();
	//float voltage[120] = { -3.20679,- 3.20679,- 3.20648,- 3.20648,- 3.20648,- 3.20679,- 3.20679,- 3.20709,- 3.20648,- 3.20648,- 3.20648,- 3.20679,- 3.20648,- 3.20709,- 3.20648,- 3.20709,- 3.20679,- 3.20679,- 3.20709,- 3.20679,0.31464,0.31494,0.31494,0.31403,0.31494,0.31464,0.31494,0.31494,0.31464,0.31464,0.31494,0.31494,0.31464,0.31403,0.31494,0.31525,0.31494,0.31494,0.31464,0.31525,0.31494,0.31494,0.31525,0.31433,0.31525,0.31494,0.31494,0.31494,0.31494,0.31494,0.31494,0.31494,0.31525,0.31433,0.31525,0.31494,0.31494,0.31525,0.31494,0.31494,0.31494,0.31525,0.31525,0.31494,0.31525,0.31433,0.31494,0.31525,0.31494,0.31525,0.31494,0.31525,0.31525,0.31494,0.31525,0.31494,0.31494,0.31525,0.31494,0.31494,0.31494,0.31494,0.31494,0.31494,0.31494,0.31555,0.31494,0.31494,0.31525,0.31494,0.31525,0.31372,0.31464,0.31525,0.31494,0.31494,0.31525,0.31433,0.31494,0.31494,0.31433,0.31525,0.31494,0.31494,0.31464,0.31494,0.31494,0.31494,0.31494,0.31494,0.31494,0.31464,0.31494,0.31464,0.31494,0.31494,0.31494,0.31433,0.31494,0.31525};
	//float voltage[120] = { -2.99896,-2.99866,-2.99866 ,-2.99896,-2.99866,-2.99866,-2.99866,-2.99866,-2.99866,-2.99866,-2.99866,-2.99866,-2.99805,-2.99866,-2.99805,-2.99866,-2.99866,-2.99866,-2.99866,-2.99866,-1.58783,-1.58783,-1.58752,-1.58752,-1.58813,-1.58813,-1.58783,-1.58783,-1.58813,-1.58813,-1.58783,-1.58813,-1.58783,-1.58783,-1.58752,-1.58783,-1.58783,-1.58722,-1.58783,-1.58813,-1.58783,-1.58783,-1.58813,-1.58813,-1.58752,-1.58813,-1.58783,-1.58752,-1.58752,-1.58752,-1.58783,-1.58844,-1.58783,-1.58752,-1.58752,-1.58752,-1.58783,-1.58813,-1.58783,-1.58752,-1.58783,-1.58813,-1.58813,-1.58813,-1.58813,-1.58722,-1.58783,-1.58783,-1.58783,-1.58813,-1.58752,-1.58752,-1.58783,-1.58752,-1.58752,-1.58752,-1.58844,-1.58783,-1.58783,-1.58783,-1.58813,-1.58783,-1.58783,-1.58813,-1.58722,-1.58813,-1.58752,-1.58783,-1.58813,-1.58783,-1.58783,-1.58813,-1.58813,-1.58813,-1.58813,-1.58844,-1.58813,-1.58813,-1.58813,-1.58783,-1.58783,-1.58844,-1.58813,-1.58783,-1.58813,-1.58813,-1.58783,-1.58813,-1.58813,-1.58783,-1.58783,-1.58844,-1.58813,-1.58813,-1.58875,-1.58813,-1.58875,-1.58875,-1.58875,-1.58875};
	//float voltage[120] = { -2.93854,-2.93884,-2.93823,-2.93823,-2.93884,-2.93915,-2.93823,-2.93854,-2.93884,-2.93884,-2.93884,-2.93884,-2.93823,-2.93884,-2.93854,-2.93854,-2.93854,-2.93884,-2.93854,-2.93884,-2.63977,-2.63916,-2.63916,-2.63947,-2.64008,-2.64038,-2.63977,-2.64038,-2.63977,-2.63977,-2.64038,-2.63977,-2.63947,-2.63977,-2.63977,-2.63977,-2.63977,-2.63916,-2.63916,-2.63977,-2.63977,-2.64008,-2.63947,-2.63977,-2.63977,-2.64008,-2.64038,-2.63977,-2.63916,-2.63947,-2.63977,-2.63977,-2.63977,-2.64008,-2.63977,-2.63977,-2.63977,-2.63916,-2.64008,-2.64038,-2.64008,-2.64008,-2.64008,-2.63977,-2.63977,-2.64069,-2.64008,-2.63977,-2.64008,-2.64038,-2.63977,-2.64008,-2.63977,-2.63977,-2.63947,-2.63977,-2.64008,-2.63977,-2.64008,-2.63947,-2.63916,-2.63977,-2.63977,-2.63977,-2.64008,-2.64008,-2.64038,-2.64038,-2.64008,-2.64038,-2.63947,-2.63977,-2.64099,-2.64038,-2.63977,-2.64008,-2.64008,-2.63977,-2.63916,-2.64008,-2.63977,-2.64038,-2.63977,-2.63947,-2.63977,-2.64038,-2.64008,-2.64008,-2.63977,-2.63885,-2.64038,-2.63977,-2.64038,-2.63977,-2.63977,-2.64008,-2.63977,-2.64008,-2.64008,-2.64008 };
	
	float voltage[202];//PLC传递o我们201个数据的数值，根据地201个判断
	float* dianzulv::find_U(float voltage[]);//初始120个电压数据寻找最大最小值处理函数
	float* dianzulv::find_P(float voltage[]);//初始120个电压数据得到电阻率处理函数
	int m = 200;//数组个数
	void dianzulv::PLCthread();   //PLC多线程，一直接收PLC数据
	void dianzulv::draw();       //电阻率绘图函数
	unsigned long lHdlVar1;      //PLC通讯句柄
	static dianzulv* m_dianzulv;  //静态赋值变量
	bool m_plcRun;  //等待线程ID               
	std::thread t;   // 线程定义
	QSplineSeries *series;  // 电压折线
	QSplineSeries *series2; // 电阻率折线
	QChart *chart;
	QChart *chart2;

private:
    Ui::dianzulvClass ui;
signals:
	void SignDraw(); //绘图信号
	void SignPN(); //PN电阻率信号


public slots:
	void SlotDraw();//绘图槽函数
	void SlotPN();//PN电阻率槽函数
};
